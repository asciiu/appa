syntax = "proto3";

package plan;
//import "order-service/proto/order/order.proto";
import "github.com/asciiu/gomo/plan-service/proto/order/order.proto";

service PlanService {
  rpc AddPlan(PlanRequest) returns (PlanResponse) {}
  rpc GetUserPlan(GetUserPlanRequest) returns (PlanWithPagedOrdersResponse) {}
  rpc GetUserPlans(GetUserPlansRequest) returns (PlansPageResponse) {}
  rpc DeletePlan(DeletePlanRequest) returns (PlanResponse) {}
  rpc UpdatePlan(UpdatePlanRequest) returns (PlanResponse) {}
}

// Requests
message PlanRequest {
  string planID = 1;
  string userID = 2;
  string keyID = 3;
  string planTemplateID = 4;
  string exchange = 5;
  string marketName = 6;
  double baseBalance = 7;
  double currencyBalance = 8;
  string status = 9;
  repeated order.OrderRequest orders = 10; 
}


message GetUserPlanRequest {
  string planID = 1;
  string userID = 2;
  uint32 page = 3;
  uint32 pageSize = 4;
}

message GetUserPlansRequest {
    string userID = 1;
    string exchange = 2; 
    string marketName = 3;
    string status = 4;
    uint32 page = 5;
    uint32 pageSize = 6;
}

message DeletePlanRequest {
  string planID = 1;
  string userID = 2;
}

message UpdatePlanRequest {
  string planID = 1;
  string userID = 2;
  string status = 3;
  double baseBalance = 4;
  double currencyBalance = 5;
}

// Responses
message Plan {
  string planID = 1;
  string planTemplateID = 2;
  string userID = 3;
  string keyID = 4;
  string key = 5;
  string keySecret = 6;
  string keyDescription = 7;
  uint32 executedOrderNumber = 8;
  string exchange = 9;
  string exchangeMarketName = 10;
  string marketName = 11;
  double baseBalance = 12;
  double currencyBalance = 13;
  string status = 14;
  string createdOn = 15;
  string updatedOn = 16;
  repeated order.Order orders = 17; 
}

message PlanWithPagedOrders {
  string planID = 1;
  string planTemplateID = 2;
  string userID = 3;
  string keyID = 4;
  string key = 5;
  string keySecret = 6;
  string keyDescription = 7;
  string exchange = 8;
  string exchangeMarketName = 9;
  string marketName = 10;
  double baseBalance = 11;
  double currencyBalance = 12;
  string status = 13;
  string createdOn = 14;
  string updatedOn = 15;
  order.OrdersPage ordersPage = 16;
}

message PlanData {
  Plan plan = 1;
}

message PlanResponse {
  string status = 1;
  string message = 2;
  PlanData data = 3;
}

message PlanWithPagedOrdersResponse {
  string status = 1;
  string message = 2;
  PlanWithPagedOrders data = 3;
}

message PlansPageResponse {
  string status = 1;
  string message = 2;
  PlansPage data = 3;
}

message PlansPage {
  uint32 page = 1;
  uint32 pageSize = 2; 
  uint32 total = 3;
  repeated Plan plans = 4; 
}